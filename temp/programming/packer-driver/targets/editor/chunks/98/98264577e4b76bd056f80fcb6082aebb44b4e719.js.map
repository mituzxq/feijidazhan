{"version":3,"sources":["file:///C:/Users/zxq/Desktop/%E9%A3%9E%E6%9C%BA%E5%A4%A7%E6%88%98/NewProject/assets/script/GameManger.ts"],"names":["_decorator","Component","Contact2DType","instantiate","PhysicsSystem2D","Prefab","director","PlayerBullet","Enemy","EnemyBullet","ccclass","property","GameManger","type","dieNumber","stop","start","playerbullet","ememy","instance","on","BEGIN_CONTACT","onBeginContact","update","deltaTime","schedule","buller","playerbullerPre","setParent","node","parent","player","getChildByName","position","setPosition","x","y","ememyX","Math","floor","random","enemy","enemyPre","enemypos","enemybullerPre","enemybullet","selfCollider","otherCollider","contact","tag","getComponent","die","destroy","alert","purgeDirector"],"mappings":"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","sourcesContent":["import { _decorator, Component, Collider2D, Contact2DType, instantiate, IPhysics2DContact, PhysicsSystem2D, Prefab, director } from 'cc';\nimport { PlayerBullet } from './PlayerBullet';\nimport { Enemy } from './Enemy';\nimport { EnemyBullet } from './EnemyBullet';\nconst { ccclass, property } = _decorator;\n@ccclass('GameManger')\nexport class GameManger extends Component {\n    @property({ type: Prefab })\n    playerbullerPre: Prefab | null = null;\n\n    @property({ type: Prefab })\n    enemyPre: Prefab | null = null;\n\n    @property({ type: Prefab })\n    enemybullerPre: Prefab | null = null;\n\n    dieNumber: number = 0;\n\n    start() {\n        this.playerbullet();\n        this.ememy();\n        PhysicsSystem2D.instance.on(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\n    }\n\n    update(deltaTime: number) {\n\n    }\n\n    playerbullet() {\n        this.schedule(() => {\n            let buller = instantiate(this.playerbullerPre);\n            buller.setParent(this.node.parent);\n            let player = this.node.parent.getChildByName(\"hero\").position;\n            buller.setPosition(player.x, player.y + 50, 0);\n        }, 1)\n    }\n    stop = 0;\n    ememy() {\n        this.schedule(() => {\n            let ememyX = Math.floor(Math.random() * 330) - 165;\n            let enemy = instantiate(this.enemyPre);\n            enemy.setParent(this.node.parent.getChildByName(\"EnemyAll\"));\n            enemy.setPosition(ememyX, 550, 0);\n            let enemypos = enemy.position;\n            // this.enemybullet();\n\n            if (this.stop == 0) {\n                this.schedule(() => {\n                    let buller = instantiate(this.enemybullerPre);\n                    buller.setParent(this.node.parent.getChildByName(\"EnemyAll\"));\n                    buller.setPosition(enemypos.x, enemypos.y - 30, 0);\n                }, 0.5)\n            }\n        }, 1)\n    }\n\n\n    enemybullet() {\n        this.schedule(() => {\n            let buller = instantiate(this.enemybullerPre);\n            buller.setParent(this.node.parent.getChildByName(\"EnemyAll\"));\n            let position = buller.parent.getChildByName(\"enemy\").position;\n            buller.setPosition(position.x, position.y - 30, 0);\n        }, 0.5)\n    }\n\n    onBeginContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null) {\n        if ((selfCollider.tag == 1 && otherCollider.tag == 2) || (selfCollider.tag == 2 && otherCollider.tag == 1)) {\n            if (selfCollider.tag == 1) {\n                selfCollider.getComponent(PlayerBullet).die();\n                otherCollider.getComponent(Enemy).die();\n                this.node.parent.getChildByName(\"EnemyAll\").getChildByName(\"enemybullet\").getComponent(EnemyBullet).die();\n            }\n            if (selfCollider.tag == 2) {\n                selfCollider.getComponent(Enemy).die();\n                otherCollider.getComponent(PlayerBullet).die();\n                this.node.parent.getChildByName(\"EnemyAll\").getChildByName(\"enemybullet\").getComponent(EnemyBullet).die();\n            }\n            this.node.parent.getChildByName(\"EnemyAll\").getChildByName(\"enemybullet\").destroy;\n            // this.score();\n\n        }\n        if ((selfCollider.tag == 0 && otherCollider.tag == 2) || (selfCollider.tag == 2 && otherCollider.tag == 0)) {\n            alert(\"你以死亡，分数：\" + this.dieNumber);\n            director.purgeDirector();\n        }\n    }\n    // score() {\n    //     let t = this.dieNumber++;\n    //     this.printScore();\n    // }\n    // printScore() {\n    //     let score = this.node.children[1];\n    //     score.getComponent(Label).string = this.dieNumber + \"\";\n    // }\n\n}\n\n"]}