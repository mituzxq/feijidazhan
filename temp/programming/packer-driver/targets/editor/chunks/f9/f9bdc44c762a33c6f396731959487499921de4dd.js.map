{"version":3,"sources":["file:///C:/Users/zxq/Desktop/%E9%A3%9E%E6%9C%BA%E5%A4%A7%E6%88%98/NewProject/assets/script/Enemy.ts"],"names":["_decorator","Component","instantiate","Prefab","assert","ccclass","property","Enemy","type","instance","_instance","audioManager","init","audioSource","_audioSource","playMusic","loop","playing","play","playSound","name","volumeScale","playOneShot","audioClip","setMusicVolume","flag","clamp01","volume","start","enemybullet","update","deltaTime","bulletY","node","position","y","speed","setPosition","x","die","schedule","buller","enemybullerPre","setParent","parent","enemydiePre","destroy"],"mappings":";;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,M,OAAAA,M;AAAgCC,MAAAA,M,OAAAA,M;;;;;;;OACvE;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;;uBAGjBO,K,WADZF,OAAO,CAAC,OAAD,C,UAEHC,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEL;AAAR,OAAD,C,UAGRG,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEL;AAAR,OAAD,C,sCALb,MACaI,KADb,SAC2BN,SAD3B,CACqC;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAad,mBAARQ,QAAQ,GAAG;AAClB,cAAI,KAAKC,SAAT,EAAoB;AAChB,mBAAO,KAAKA,SAAZ;AACH;;AAED,eAAKA,SAAL,GAAiB,IAAIC,YAAJ,EAAjB;AACA,iBAAO,KAAKD,SAAZ;AACH;AAED;;;AACAE,QAAAA,IAAI,CAACC,WAAD,EAA2B;AAC3BF,UAAAA,YAAY,CAACG,YAAb,GAA4BD,WAA5B;AACH;AAED;AACJ;AACA;AACA;;;AACIE,QAAAA,SAAS,CAACC,IAAD,EAAgB;AACrB,gBAAMH,WAAW,GAAGF,YAAY,CAACG,YAAjC;AACAV,UAAAA,MAAM,CAACS,WAAD,EAAc,0BAAd,CAAN;AAEAA,UAAAA,WAAW,CAACG,IAAZ,GAAmBA,IAAnB;;AACA,cAAI,CAACH,WAAW,CAACI,OAAjB,EAA0B;AACtBJ,YAAAA,WAAW,CAACK,IAAZ;AACH;AACJ;AAED;AACJ;AACA;AACA;AACA;;;AACIC,QAAAA,SAAS,CAACC,IAAD,EAAeC,WAAmB,GAAG,CAArC,EAAwC;AAC7C,gBAAMR,WAAW,GAAGF,YAAY,CAACG,YAAjC;AACAV,UAAAA,MAAM,CAACS,WAAD,EAAc,0BAAd,CAAN,CAF6C,CAI7C;;AACAA,UAAAA,WAAW,CAACS,WAAZ,CAAwBC,SAAxB,EAAmCF,WAAnC;AAEH,SArDgC,CAsDjC;;;AACAG,QAAAA,cAAc,CAACC,IAAD,EAAe;AACzB,gBAAMZ,WAAW,GAAGF,YAAY,CAACG,YAAjC;AACAV,UAAAA,MAAM,CAACS,WAAD,EAAc,0BAAd,CAAN;AAEAY,UAAAA,IAAI,GAAGC,OAAO,CAACD,IAAD,CAAd;AACAZ,UAAAA,WAAW,CAACc,MAAZ,GAAqBF,IAArB;AACH;;AAEDG,QAAAA,KAAK,GAAG;AACJ,eAAKC,WAAL;AACH;;AAEDC,QAAAA,MAAM,CAACC,SAAD,EAAoB;AACtB,cAAIC,OAAO,GAAG,KAAKC,IAAL,CAAUC,QAAV,CAAmBC,CAAjC;AACAH,UAAAA,OAAO,IAAI,KAAKI,KAAL,GAAaL,SAAxB;AACA,eAAKE,IAAL,CAAUI,WAAV,CAAsB,KAAKJ,IAAL,CAAUC,QAAV,CAAmBI,CAAzC,EAA4CN,OAA5C,EAAqD,CAArD;;AACA,cAAIA,OAAO,GAAG,CAAC,GAAf,EAAoB;AAChB,iBAAKO,GAAL;AACH;AACJ,SA1EgC,CA4EjC;;;AACAV,QAAAA,WAAW,GAAG;AACV,eAAKW,QAAL,CAAc,MAAM;AAChB,gBAAIC,MAAM,GAAGvC,WAAW,CAAC,KAAKwC,cAAN,CAAxB;AACAD,YAAAA,MAAM,CAACE,SAAP,CAAiB,KAAKV,IAAL,CAAUW,MAA3B;AACA,gBAAIV,QAAQ,GAAG,KAAKD,IAAL,CAAUC,QAAzB;AACAO,YAAAA,MAAM,CAACJ,WAAP,CAAmBH,QAAQ,CAACI,CAA5B,EAA+BJ,QAAQ,CAACC,CAAT,GAAa,EAA5C,EAAgD,CAAhD;AACH,WALD,EAKG,GALH;AAMH;;AAEDI,QAAAA,GAAG,GAAG;AACF;AACA;AACA;AACA;AACA;AACA;AACA,cAAIA,GAAG,GAAGrC,WAAW,CAAC,KAAK2C,WAAN,CAArB;AACAN,UAAAA,GAAG,CAACI,SAAJ,CAAc,KAAKV,IAAL,CAAUW,MAAxB;AACAL,UAAAA,GAAG,CAACF,WAAJ,CAAgB,KAAKJ,IAAL,CAAUC,QAA1B;AAEA,eAAKD,IAAL,CAAUa,OAAV;AACH;;AAlGgC,O,UAUlBpC,S,mBACAI,Y;;;;;iBATiB,I;;;;;;;iBAGH,I;;gFAE5BR,Q;;;;;iBACe,G","sourcesContent":["import { _decorator, Component, instantiate, Prefab, AudioSource, AudioClip, assert } from 'cc';\nconst { ccclass, property } = _decorator;\n\n@ccclass('Enemy')\nexport class Enemy extends Component {\n    @property({ type: Prefab })\n    enemybullerPre: Prefab | null = null;\n\n    @property({ type: Prefab })\n    enemydiePre: Prefab | null = null;\n\n    @property\n    speed: number = 100;\n\n    private static _instance: audioManager;\n    private static _audioSource?: AudioSource;\n\n    static get instance() {\n        if (this._instance) {\n            return this._instance;\n        }\n\n        this._instance = new audioManager();\n        return this._instance;\n    }\n\n    /**管理器初始化*/\n    init(audioSource: AudioSource) {\n        audioManager._audioSource = audioSource;\n    }\n\n    /**\n   * 播放音乐\n   * @param {Boolean} loop 是否循环播放\n   */\n    playMusic(loop: boolean) {\n        const audioSource = audioManager._audioSource!;\n        assert(audioSource, 'AudioManager not inited!');\n\n        audioSource.loop = loop;\n        if (!audioSource.playing) {\n            audioSource.play();\n        }\n    }\n\n    /**\n    * 播放音效\n    * @param {String} name 音效名称\n    * @param {Number} volumeScale 播放音量倍数\n    */\n    playSound(name: string, volumeScale: number = 1) {\n        const audioSource = audioManager._audioSource!;\n        assert(audioSource, 'AudioManager not inited!');\n\n        // 注意：第二个参数 “volumeScale” 是指播放音量的倍数，最终播放的音量为 “audioSource.volume * volumeScale”\n        audioSource.playOneShot(audioClip, volumeScale);\n\n    }\n    // 设置音乐音量\n    setMusicVolume(flag: number) {\n        const audioSource = audioManager._audioSource!;\n        assert(audioSource, 'AudioManager not inited!');\n\n        flag = clamp01(flag);\n        audioSource.volume = flag;\n    }\n\n    start() {\n        this.enemybullet();\n    }\n\n    update(deltaTime: number) {\n        let bulletY = this.node.position.y;\n        bulletY -= this.speed * deltaTime;\n        this.node.setPosition(this.node.position.x, bulletY, 0);\n        if (bulletY < -300) {\n            this.die();\n        }\n    }\n\n    //给敌机生成子弹\n    enemybullet() {\n        this.schedule(() => {\n            let buller = instantiate(this.enemybullerPre);\n            buller.setParent(this.node.parent);\n            let position = this.node.position;\n            buller.setPosition(position.x, position.y - 30, 0);\n        }, 0.5)\n    }\n\n    die() {\n        // resources.load(\"img/enemydie.png\", SpriteFrame, (err, res) => {\n        //     if (err) {\n        //         console.log(err);\n        //     }\n        //     this.node.getComponent(Sprite).spriteFrame = res;\n        // })\n        let die = instantiate(this.enemydiePre);\n        die.setParent(this.node.parent);\n        die.setPosition(this.node.position);\n\n        this.node.destroy();\n    }\n\n}"]}